import csv
import time

class CSVAppender:
    def __init__(self, filename='data.csv'):
        self.filename = filename
        self.file = open(filename, 'a', newline='')
        self.writer = csv.writer(self.file)

        # Check if the file already has content
        # If not, write headers
        if self.file.tell() == 0:
            self.writer.writerow(["timestamp", "num1", "operator", "num2", "timetaken"])

    def append(self, timestamp, num1, operator, num2, timetaken):
        self.writer.writerow([timestamp, num1, operator, num2, timetaken])
        # If you want to ensure data is written immediately (not buffered), uncomment next line:
        # self.file.flush()

    def close(self):
        self.file.close()

# Sample usage:
appender = CSVAppender()
appender.append(time.time(), 5, '+', 3, 2.3)
time.sleep(5)
appender.append(time.time(), 7, '*', 4, 1.8)
appender.close()1695289771.476664,59,+,5,1.28,False,False,120
1695289772.2634618,9,*,2,0.786,False,False,120
1695289774.7259781,222,/,3,2.462,False,False,120
1695289777.024485,882,/,9,2.298,False,False,120
1695289783.367813,7,*,48,6.343,True,False,120
1695289785.245165,30,-,52,1.877,False,False,120
1695289787.710724,6,*,32,2.465,True,False,120
1695289790.918754,12,*,54,3.208,False,False,120
1695289798.958525,470,/,5,8.04,False,False,120
1695289800.029354,60,+,6,1.071,False,False,120
1695289801.271648,23,+,62,1.242,False,False,120
1695289803.253812,32,-,47,1.982,False,False,120
1695289804.098273,4,*,2,0.844,False,False,120
1695289815.296561,245,/,7,11.198,False,False,120
1695289820.8185868,9,*,88,5.522,False,False,120
1695292509.3154309,25,+,99,1.402,False,False,120
1695292510.217819,8,*,7,0.902,False,False,120
1695292511.469507,12,*,100,1.252,False,False,120
1695292514.2450612,37,-,62,2.775,False,False,120
1695292517.2523541,640,/,8,3.007,False,False,120
1695292519.211333,82,+,4,1.959,False,False,120
1695292520.978393,50,+,77,1.767,False,False,120
1695292522.467904,82,-,87,1.489,False,False,120
1695292532.505644,708,/,12,10.038,False,False,120
1695292534.459316,73,+,24,1.954,False,False,120
1695292536.2099452,23,+,74,1.751,False,False,120
1695292538.217522,58,-,35,2.008,False,False,120
1695292539.508141,17,-,37,1.291,False,False,120
1695292605.087359,12,*,77,65.579,True,False,120
1695292607.7540438,45,+,81,2.667,False,False,120
1695292609.265326,2,*,53,1.511,False,False,120
1695292612.146741,276,/,12,2.881,False,False,120
1695292613.894295,8,*,12,1.747,True,False,120
1695292615.596233,63,-,55,1.702,False,False,120
1695292616.679586,10,*,81,1.083,False,False,120
1695292618.6636102,30,+,13,1.984,True,False,120
1695292619.78804,96,/,3,1.124,False,False,120
1695292622.649467,93,+,78,2.861,False,False,120
1695292623.6064472,57,-,53,0.957,False,False,120
1695292626.325239,26,-,74,2.719,False,False,120
1695292627.161098,48,/,12,0.836,False,False,120
1695292635.334708,73,-,96,3.822,False,False,120
1695292636.509185,86,-,46,1.174,False,False,120
1695292639.4599712,44,-,78,2.951,False,False,120
1695292642.434915,4,*,28,2.975,False,False,120
1695292646.081534,5,*,59,3.647,False,False,120
1695292648.1511161,52,-,45,2.07,False,False,120
1695292649.641382,31,-,2,1.49,False,False,120
1695292654.563862,5,*,75,4.922,True,False,120
1695292657.230921,5,*,25,2.667,True,False,120
1695292658.1369631,10,*,18,0.906,False,False,120
1695292659.695481,89,-,65,1.558,False,False,120
1695292662.479496,15,-,74,2.784,False,False,120
1695292663.737803,90,/,3,1.258,False,False,120
1695292665.0082219,67,-,50,1.27,False,False,120
1695292667.994795,18,+,93,2.987,False,False,120
1695292670.1092181,27,-,51,2.114,False,False,120
1695292671.0458171,43,-,43,0.937,False,False,120
1695292672.214425,68,+,4,1.169,False,False,120
1695292677.510389,288,/,6,5.296,False,False,120
1695292678.94888,18,+,99,1.438,False,False,120
1695292684.259101,9,*,62,5.31,False,False,120
1695292689.5711958,11,*,71,5.312,False,False,120
1695292692.8995478,75,-,89,3.328,False,False,120
1695292694.5285819,70,-,45,1.629,False,False,120
1695292695.228757,4,*,2,0.7,False,False,120
1695292697.436907,24,-,45,2.208,False,False,120
1695292699.002913,60,+,84,1.566,False,False,120
1695292702.1945071,648,/,12,3.192,False,False,120
1695292703.2483141,540,/,10,1.054,False,False,120
1695292705.262133,2,+,27,2.014,False,False,120
1695292708.227093,9,*,62,2.965,False,False,120
1695292710.0637188,4,*,71,1.837,False,False,120
1695292711.978088,83,+,81,1.914,False,False,120
1695292718.546367,913,/,11,6.568,False,False,120
1695292719.5222132,6,*,11,0.976,False,False,120
1695292721.106096,144,/,6,1.584,False,False,120
1695292722.72033,33,+,24,1.614,False,False,120
1695292723.650267,97,-,95,0.93,False,False,120
1695292726.4651132,64,-,97,2.815,False,False,120
1695292727.4525728,10,*,11,0.987,False,False,120
1695292728.905153,14,-,54,1.453,False,False,120
1695292730.392996,44,-,38,1.488,False,False,120
1695292732.599564,100,-,13,2.207,False,False,120
1695292735.760542,11,*,83,3.161,False,False,120
1695292736.84557,4,*,60,1.085,False,False,120
1695292740.541357,679,/,7,3.696,False,False,120
